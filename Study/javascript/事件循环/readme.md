###  浏览器的进程模型

**何为进程**
是指电脑中已执行的程序，曾经是分时系统的基本运作单位。在面向进程设计的系统（如早期的UNIX，Linux 2.4及更早的版本）中，是程序的基本执行实体；在面向线程设计的系统（如当代多数操作系统、Linux 2.6及更新的版本）中，进程本身不是基本执行单位，而是执行线程的容器。

**简单来说 程序运行需要有内存空间，这块内存空间简单的理解为进程**

**每个应用至少有一个进程，进程之间相互独立，即使要通信，也需要双方同意**


**何为线程**

运行程序的一个基本执行单位，一个进程包括一个或多个线程。进程开启后会自动创建一个线程来执行代码，该线程称为主线程。

如果程序需要同时执行多块代码，主线程就会启动更多的线程来执行代码，所以一个进程中可以包含多个线程。



#### 浏览器有哪些进程和线程？

**浏览器是一个多进程多线程的应用程序**

谷歌浏览器三大进程

1: 浏览器进程
2: 网络进程
3: 渲染进程


**浏览器进程**

主要负责界面显示，用户交互，子进程管理等，浏览器进程内部会启动多个线程处理不同的任务。

**网络进程**

负责加载网络资源，网络进程内部会启动多个线程来处理不同的网络任务。

**渲染进程**

渲染进程启动后，会开启一个渲染主线程，主线程负责执行 HTML、JS、CSS代码


### 渲染主线程是如何工作的？

解析HTML

解析CSS

计算样式

布局

执行JS

....



### js事件循环

```js
事件循环又叫消息循环，是浏览器渲染主线程的工作方式。
在Chrome的源码中，它会开启一个不会结束的循环，每次循环从消息队列中取出第一个任务去执行，而其他线程只需在合适的时候把任务加到队列末尾即可。

过去把消息队列分为宏队列和微队列。这种说法目前已经无法满足复杂的浏览器环境，取而代之的是另一种更加灵活多变的处理方式。

根据W3C官方的解释，每个任务有不同的类型，同类型的任务必须在同一个队列，不同的任务可以属于不同的队列，不同任务队列有不同的优先级，在一次事件循环中，由浏览器自行决定取哪一个队列的任务，但浏览器必须有一个微队列，微队列的任务一定是具有最高的优先级。

```




#### 如何理解JS的异步

```js

JS是一门单线程语言，这是因为它运行在浏览器的渲染主线程中，渲染主线程只有一个，
而渲染主线程承担着诸多的工作，渲染页面、执行JS都在其中运行。

如果使用同步的方式，那么就很有可能造成主线程的阻塞，从而导致事件队列里的很多其他任务都无法执行。

这样一来，一方面会导致主线程白白的浪费时间，一方面导致页面不能及时更新，给用户造成卡死现象。

所以浏览器采用异步的方式来避免。具体做法是当某些任务（计时器、网络、事件监听）发生时，主线程将任务交给其他线程去处理，自身立即结束任务的执行，转而执行其他后续任务，当其他线程完成后，将事先传递的回调函数包装成任务放入事件队列的末尾，排队等待主线程调度执行。

所以异步的话，浏览器将永不阻塞，流畅运行。

```
 


#### JS的计时器可以做到精准计时吗？

```js
不行，因为：

1: 受事件循环的影响，计时器的回调函数只能在主线程空闲时间运行，会带来偏差。

2: 按照W3C的标准，浏览器实现计时器时，如果嵌套层数超过5层，则会带有4ms的最少时间，这样有偏差

3: 计算机硬件没有原子钟，无法做到精准计时
```